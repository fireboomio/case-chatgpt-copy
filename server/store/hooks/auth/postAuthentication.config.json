{"path":"auth/postAuthentication","depend":null,"script":"import { createClient } from 'generated/client'\nimport { AuthenticationHookRequest } from 'fireboom-wundersdk/server'\n\nexport default async function postAuthentication(hook: AuthenticationHookRequest) : Promise\u003cvoid\u003e{\n  if (hook.user) {\n    const client = createClient()\n    const { avatarUrl, email, name, nickName, provider, providerId, userId } = hook.user\n    const resp = await client.query({\n        operationName: 'GetOneUser',\n      input: {\n        providerUserId: userId!\n      }\n    })\n    if (resp.status === 'ok') {\n      if (!resp.body.errors) {\n        const existedUser = resp.body.data!.data\n        if (!existedUser) {\n          const _name = nickName || name || email!\n          const rest = await client.mutation.CreateOneUser({\n            input: {\n              data: {\n                name: _name,\n                provider: provider!,\n                providerId: providerId!,\n                providerUserId: userId!,\n                avatarUrl: avatarUrl\n              }\n            }\n          })\n          if (rest.status === 'ok') {\n            if (!rest.body.errors) {\n              console.info(`Success sync user: ${providerId} - ${_name}`)\n            }\n          }\n        }\n      }\n    }\n  }\n}","enabled":true,"scriptType":"","input":null,"type":""}